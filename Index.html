<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Beat the Bookie</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#000000;
      --gold: rgb(179,167,119);
      --goldA: rgba(179,167,119,0.35);
      --panel:#111;
      --input:#222;
      --text:#e8e8e8;
      --pos:#35d07f;
      --neg:#ff5c5c;
    }
    *{box-sizing:border-box}
    body{ margin:0; background:var(--bg); color:var(--gold); font-family:'Roboto',sans-serif; }
    h1{ margin:0; padding:12px 10px; text-align:center; color:var(--gold); font-size:20px; }

    /* Compacte invoer */
    .form-wrap{
      margin:10px; padding:10px; background:var(--panel);
      border:1px solid var(--gold); border-radius:10px; box-shadow:0 0 10px var(--goldA);
      overflow:hidden;
    }
    .form-grid{
      display:grid;
      grid-template-columns: 72px repeat(3, minmax(0,1fr));
      gap:6px;
      align-items:center;
    }
    .form-grid .head{
      font-weight:700; color:#fff; text-align:center; padding:4px 0; font-size:14px;
    }
    .form-grid .row-label{ color:var(--gold); font-size:12px; }
    .in{
      width:100%; padding:8px; border:1px solid var(--gold);
      border-radius:8px; background:var(--input); color:#fff; text-align:center; font-size:14px;
    }

    .actions{ display:flex; gap:8px; padding:0 10px 10px; justify-content:center; flex-wrap:wrap; }
    button{
      background:var(--gold); color:#000; border:none; padding:10px 14px; border-radius:10px;
      cursor:pointer; font-weight:700; font-size:14px;
    }
    button:hover{ filter:brightness(1.05); }

    .results{
      margin:10px; padding:10px; border:1px solid var(--gold); border-radius:10px; background:var(--panel);
      box-shadow:0 0 10px var(--goldA); overflow:hidden;
    }
    .metrics{ display:flex; gap:8px; flex-wrap:wrap; justify-content:center; }
    .metric{
      min-width:140px; padding:8px; border:1px solid var(--gold); border-radius:8px; text-align:center;
      background:#0f0f0f;
    }
    .metric .label{ color:var(--gold); font-size:11px; }
    .metric .value{ color:#fff; font-size:16px; font-weight:700; margin-top:2px; }

    table{ width:100%; border-collapse:collapse; margin-top:10px; }
    th,td{ border:1px solid var(--gold); padding:6px; text-align:center; color:#fff; font-size:14px; }
    th{ color:#000; background:var(--gold); }
    .foot{ margin-top:8px; color:var(--text); font-size:13px; opacity:.95; text-align:center; }

    .pos{ color:var(--pos); font-weight:700; }
    .neg{ color:var(--neg); font-weight:700; }
  </style>
</head>
<body>
  <h1>Beat the Bookie</h1>

  <!-- Matrix invoer -->
  <div class="form-wrap">
    <div class="form-grid">
      <div></div>
      <div class="head">1</div>
      <div class="head">X</div>
      <div class="head">2</div>

      <div class="row-label">Odd</div>
      <input class="in" type="number" id="odd1" step="0.01" placeholder="1.65">
      <input class="in" type="number" id="oddX" step="0.01" placeholder="4.60">
      <input class="in" type="number" id="odd2" step="0.01" placeholder="5.60">

      <div class="row-label">Stake (€)</div>
      <input class="in" type="number" id="stake1" step="0.01" placeholder="0">
      <input class="in" type="number" id="stakeX" step="0.01" placeholder="0">
      <input class="in" type="number" id="stake2" step="0.01" placeholder="0">

      <div class="row-label">Free Bet (€)</div>
      <input class="in" type="number" id="fb1" step="0.01" placeholder="0">
      <input class="in" type="number" id="fbX" step="0.01" placeholder="0">
      <input class="in" type="number" id="fb2" step="0.01" placeholder="0">
    </div>
  </div>

  <div class="actions">
    <button id="btnBalance">Bereken overige stakes</button>
    <button id="btnReset">Reset</button>
  </div>

  <div class="results" id="results" style="display:none;">
    <div class="metrics" id="metrics"></div>

    <!-- Resultaten tabel -->
    <table id="outcomesTbl" style="display:none;">
      <thead>
        <tr>
          <th></th>
          <th>1</th>
          <th>X</th>
          <th>2</th>
        </tr>
      </thead>
      <tbody id="outcomesBody"></tbody>
    </table>

    <div class="foot" id="totalsFoot"></div>
  </div>

  <script>
    const val = id => parseFloat(document.getElementById(id).value) || 0;
    const hasVal = id => document.getElementById(id).value.trim() !== "";

    function allOddsFilled(){
      return hasVal('odd1') && hasVal('oddX') && hasVal('odd2') &&
             val('odd1')>0 && val('oddX')>0 && val('odd2')>0;
    }

    function payoutFor(odd, stake, fb){
      return (odd * stake) + ((odd - 1) * fb);
    }

    function calcOddsOnlyReturn(){
      const o1 = val('odd1'), oX = val('oddX'), o2 = val('odd2');
      const sumInv = 1/o1 + 1/oX + 1/o2;
      if(sumInv <= 0) return null;
      return (1 / sumInv) * 100;
    }

    function fmt(n){ return (isFinite(n)? n:0).toFixed(2); }

    function money(n){
      const cls = n >= 0 ? 'pos' : 'neg';
      const sign = n >= 0 ? '+' : '-';
      return `<span class="${cls}">${sign} €${fmt(Math.abs(n))}</span>`;
    }

    function metric(label, value){
      return `<div class="metric"><div class="label">${label}</div><div class="value">${value}</div></div>`;
    }

    function trow(label, cells){
      return `<tr><td style="color:var(--gold)">${label}</td><td>${cells[0]}</td><td>${cells[1]}</td><td>${cells[2]}</td></tr>`;
    }

    function updateUI(){
      const show = allOddsFilled();
      const blk = document.getElementById('results');
      blk.style.display = show ? 'block' : 'none';
      if(!show) return;

      const o1 = val('odd1'), oX = val('oddX'), o2 = val('odd2');
      const s1 = val('stake1'), sX = val('stakeX'), s2 = val('stake2');
      const fb1 = val('fb1'), fbX = val('fbX'), fb2 = val('fb2');

      const p1 = payoutFor(o1, s1, fb1);
      const pX = payoutFor(oX, sX, fbX);
      const p2 = payoutFor(o2, s2, fb2);

      const cashTotal = s1 + sX + s2;
      const fbTotal   = fb1 + fbX + fb2;
      const totalStake = cashTotal + fbTotal;

      const oddsOnly = calcOddsOnlyReturn();
      const anyStake = totalStake > 0.0001;

      const minPayout = Math.min(p1, pX, p2);
      const currentReturn = anyStake ? (minPayout / totalStake * 100) : null;

      const profit1 = p1 - cashTotal;
      const profitX = pX - cashTotal;
      const profit2 = p2 - cashTotal;
      const minCashProfit = Math.min(profit1, profitX, profit2);

      const profit1Incl = p1 - totalStake;
      const profitXIncl = pX - totalStake;
      const profit2Incl = p2 - totalStake;
      const minCashProfitInclFB = Math.min(profit1Incl, profitXIncl, profit2Incl);

      const fbYield = fbTotal > 0 ? (minCashProfit / fbTotal * 100) : null;

      // Metrics
      const m = [];
      if(oddsOnly !== null) m.push(metric('Betting Return (odds)', oddsOnly.toFixed(2) + '%'));
      if(anyStake){
        m.push(metric('Betting Return (huidige inzet)', currentReturn.toFixed(2) + '%'));
        if(fbTotal>0) m.push(metric('Rendement Free Bet', fbYield.toFixed(2) + '%'));
      }
      document.getElementById('metrics').innerHTML = m.join('');

      // Tabel (zonder winst-rij)
      const body = document.getElementById('outcomesBody');
      body.innerHTML = [
        trow('Odd',      [fmt(o1), fmt(oX), fmt(o2)]),
        trow('Stake',    ['€'+fmt(s1), '€'+fmt(sX), '€'+fmt(s2)]),
        trow('Free Bet', ['€'+fmt(fb1), '€'+fmt(fbX), '€'+fmt(fb2)]),
        trow('Payout',   ['€'+fmt(p1), '€'+fmt(pX), '€'+fmt(p2)])
      ].join('');
      document.getElementById('outcomesTbl').style.display = 'table';

      // Totals
      document.getElementById('totalsFoot').innerHTML =
        `Min. cash winst/verlies excl. FB stake: ${money(minCashProfit)} • ` +
        `Min. cash winst/verlies incl. FB stake: ${money(minCashProfitInclFB)} • ` +
        `Totale cash-inzet: €${cashTotal.toFixed(2)} • Totale free bet: €${fbTotal.toFixed(2)} • `+
        `Totale stake: €${totalStake.toFixed(2)} • Laagste payout: €${minPayout.toFixed(2)}`;
    }

    function balanceStakes(){
      if(!allOddsFilled()){
        alert('Vul eerst alle 3 odds in.');
        return;
      }
      const o = { '1': val('odd1'), 'X': val('oddX'), '2': val('odd2') };
      const s = { '1': val('stake1'), 'X': val('stakeX'), '2': val('stake2') };
      const fb= { '1': val('fb1'),    'X': val('fbX'),    '2': val('fb2') };

      const order = ['1','X','2'];
      let refKey = order.find(k => (s[k] + fb[k]) > 0);
      if(!refKey){
        alert('Vul eerst bij één uitkomst een stake of free bet in.');
        return;
      }

      const P = (o[refKey] * s[refKey]) + ((o[refKey]-1) * fb[refKey]);

      order.forEach(k=>{
        if(k === refKey) return;
        const neededStake = Math.max(0, (P - ((o[k]-1)*fb[k])) / o[k]);
        const id = k==='1'?'stake1':k==='X'?'stakeX':'stake2';
        if(!isNaN(neededStake)) document.getElementById(id).value = neededStake.toFixed(2);
      });

      updateUI();
    }

    function resetAll(){
      ['odd1','oddX','odd2','stake1','stakeX','stake2','fb1','fbX','fb2'].forEach(id=>{
        document.getElementById(id).value = '';
      });
      document.getElementById('results').style.display='none';
    }

    ['odd1','oddX','odd2','stake1','stakeX','stake2','fb1','fbX','fb2'].forEach(id=>{
      document.getElementById(id).addEventListener('input', updateUI);
    });
    document.getElementById('btnBalance').addEventListener('click', balanceStakes);
    document.getElementById('btnReset').addEventListener('click', resetAll);
  </script>
</body>
</html>
